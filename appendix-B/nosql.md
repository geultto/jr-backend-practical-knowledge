# nosql 이란?
## 사용 이유
수평확장 용의, 대용량 처리에 특화: cassandra, hbase

고성능: rdbms가 제공하는 트랜잭션 일부 기능을 제공하지 않음으로써 성능 챙김

유연한 사용: 고정된 스키마 대신, 유연한 스키마를 가진다.

join과 같은 기능 제공하지 않는다

## 종류 
## key-value
### 종류: 다이나모 db, redis
세션관리
설정관리
캐시

## 문서 db
json과 유사한 문서를 주로 저장한다
다양한 컨텐츠 종류 관리한다
제품 카탈로그: 다양한 메타데이터를 가진 카탈로그 제공

## 칼럼 패밀리 db
key-value db의 확장판격
cassandra, hbase 
채팅 플랫폼, 대규모 iot기기 데이터 관리에 적합

```
Row Key: "user:1"
├── Column Family: "profile"
│   ├── name: "김철수"
│   ├── age: 28
│   └── email: "kim@a.com"
│
└── Column Family: "activity"
    ├── last_login: "2024-01-15"
    └── login_count: 42

Row Key: "user:2"
├── Column Family: "profile"
│   ├── name: "이영희"
│   └── age: 32          ← email 컬럼 자체가 없음 (sparse)
│
└── Column Family: "activity"
    └── last_login: "2024-01-14"
```

핵심 차이점
RDBMS: NULL도 공간을 차지하고, 모든 row가 같은 컬럼을 가져야 함
Column-Family: 값이 없으면 컬럼 자체가 존재하지 않음 (스키마리스). 각 row가 서로 다른 컬럼을 가질 수 있음, 칼럼이 패밀리로 묶일 수 있음. 

## 그래프 db
그래프처럼 노드 데이터와 연결하는 엣지 데이터가 있음. 
neo4j
소셜, 추천, 부정탐지

# 도입시 고려사항
1. 트랜잭션
2. nosql 의 종류
3. 확장성과 일관성의 트레이드오프
4. 운영, 모니터링에 관한 개발 역량 충분한지 여부

# cap 정리
일관성: 모든 노드가 같은 순간에 같은 데이터 볼 수 있다. 변경도 동일하게 적용된다
가용성: 모든 요청이 실패 또는 성공을 반환
분할내성: 네트워크 장애가 발생해도 계속 동작, 노드는 전부 살아있는데, 네트워크가 끊어져서 서로 연락이 안 되는 상황입니다.


## CAP에서의 현실
사실 분산 시스템에서 네트워크 분할은 언젠가 반드시 발생합니다. 그래서 현실적으로 P는 포기할 수 없고, 분할이 발생했을 때 C(일관성)를 선택하느냐, A(가용성)를 선택하느냐의 문제가 됩니다.

| 선택 | 분할 시 동작 | 예시 |
|------|-------------|------|
| CP | 일관성 보장, 일부 요청 거부 | MongoDB, HBase, Zookeeper |
| AP | 가용성 보장, 일시적 불일치 허용 | Cassandra, DynamoDB, CouchDB |